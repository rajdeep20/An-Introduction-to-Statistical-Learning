
#(a)
rm(list=ls())
set.seed(1)
library(ISLR)
attach(Default)
names(Default)
glm.fit=glm(default~income+balance,family=binomial,data=Auto)

#(b)
sam_size=floor(0.5*nrow(Default))
train_index=sample(seq_len(nrow(Default)),size=sam_size)
train.set=Default[train_index,]
cross.validation.set=Default[-train_index,]
actual_default=cross.validation.set$default 
glm.fit.train=glm(default~income+balance,family=binomial,data=train.set)
probability=predict(glm.fit.train,cross.validation.set,type="response")
predicted_default=rep("no",nrow(cross.validation.set))
predicted_default[probability>0.5]="yes"
contingency_table=table(predicted_default,actual_default)
contingency_table
test_error_rate=(contingency_table[1,2]+contingency_table[2,1])/sum(contingency_table)*100
test_error_rate

#(c)
set.seed(12)
sam_size=floor(0.5*nrow(Default))
train_index=sample(seq_len(nrow(Default)),size=sam_size)
train.set=Default[train_index,]
cross.validation.set=Default[-train_index,]
actual_default=cross.validation.set$default 
glm.fit.train=glm(default~income+balance,family=binomial,data=train.set)
probability=predict(glm.fit.train,cross.validation.set,type="response")
predicted_default=rep("no",nrow(cross.validation.set))
predicted_default[probability>0.5]="yes"
contingency_table=table(predicted_default,actual_default)
contingency_table
test_error_rate=(contingency_table[1,2]+contingency_table[2,1])/sum(contingency_table)*100
test_error_rate

set.seed(123)
sam_size=floor(0.5*nrow(Default))
train_index=sample(seq_len(nrow(Default)),size=sam_size)
train.set=Default[train_index,]
cross.validation.set=Default[-train_index,]
actual_default=cross.validation.set$default 
glm.fit.train=glm(default~income+balance,family=binomial,data=train.set)
probability=predict(glm.fit.train,cross.validation.set,type="response")
predicted_default=rep("no",nrow(cross.validation.set))
predicted_default[probability>0.5]="yes"
contingency_table=table(predicted_default,actual_default)
contingency_table
test_error_rate=(contingency_table[1,2]+contingency_table[2,1])/sum(contingency_table)*100
test_error_rate

set.seed(1234)
sam_size=floor(0.5*nrow(Default))
train_index=sample(seq_len(nrow(Default)),size=sam_size)
train.set=Default[train_index,]
cross.validation.set=Default[-train_index,]
actual_default=cross.validation.set$default 
glm.fit.train=glm(default~income+balance,family=binomial,data=train.set)
probability=predict(glm.fit.train,cross.validation.set,type="response")
predicted_default=rep("no",nrow(cross.validation.set))
predicted_default[probability>0.5]="yes"
contingency_table=table(predicted_default,actual_default)
contingency_table
test_error_rate=(contingency_table[1,2]+contingency_table[2,1])/sum(contingency_table)*100
test_error_rate

#(d)
set.seed(1)
sam_size=floor(0.50*nrow(Default))
train.set.index=sample(seq_len(nrow(Default)),size=sam_size)
train.set=Default[train.set.index,]
test.set=default[-train.set.index]
glm.fit.train=glm(default~income+balance+student,family=binomial,data=train.set)
probability=predict(glm.fit.train,cross.validation.set,type="response")
predicted_default=rep("no",nrow(cross.validation.set))
predicted_default[probability>0.5]="yes"
contingency_table=table(predicted_default,actual_default)
contingency_table
test_error_rate=(contingency_table[1,2]+contingency_table[2,1])/sum(contingency_table)*100
test_error_rate
